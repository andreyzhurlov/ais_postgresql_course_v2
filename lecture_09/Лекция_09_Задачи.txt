
-----------------------------------------------------------------------------
-- Представления VIEW
-----------------------------------------------------------------------------

-- hr --
6. Создайте представление, возвращающее ID сотрудника, его имя и ID отдела, в котором он работает.
7. Создайте представление, получающее ID сотрудника, его имя и ID отдела для всех сотрудников отдела с ID - 50 и позволяющее вставлять данные в таблицу employees. Проверьте вставку данных, написав соответствующие запросы. Удалите вставленные данные из таблицы.
-- hr --

/*
Задача 1: Представление с заказами клиентов

Создайте представление dev.latest_orders_view, которое содержит клиентов и их заказы, сделанные в 2024 году. 
Включите следующие поля: client_id, first_name, last_name, order_id, order_date, item_name, order_ammount.
Сортировка: по Дате заказа (По Возрастанию) и ещё по Сумме Заказа (По Убыванию)
*/


/*
Задача 2: Представление с классификацией клиентов по городам

Создайте представление dev.city_client_type_view, которое для каждого клиента указывает его город и статус:

'stolica' — если город клиента — 'Moskva'

'regional' — для всех остальных городов.

Поля: client_id, first_name, last_name, city, city_type.
*/



-- Задача 3: Пересоздайте представление из Задания 1 на Материализованное представление
-- Выбираются ли теперь данные чуть быстрее


-----------------------------------------------------------------------------
-- Оконные функции
-----------------------------------------------------------------------------
/*
Задание 1.
Для каждого департамента определить сотрудника с самой высокой зарплатой, вторым, третьим и т.д. 
а затем отобрать топ-2 зарплаты по каждому отделу.
*/

--

/*
Задание 2.
Для каждого клиента и заказа посчитать:
нарастающую сумму (running_total)
скользящее среднее за последние 3 заказа (rolling_avg)
>> Сумум заказа нужно считать с учётом всех товаров внутри него
*/

--

/*
Задание 3.
В каждом городе назначить ранг клиентам по сумме заказов, 
включая одинаковые ранги при равных значениях.
>> Сумум заказа нужно считать с учётом всех товаров внутри него
*/

--

/*
Задание 4.
Для каждого клиента сравнить сумму заказа с предыдущим заказом по дате.
Отметить одним из трёх признаков: 'N/A', 'Higher', 'Not higher'
>> Сумум заказа нужно считать с учётом всех товаров внутри него
*/
